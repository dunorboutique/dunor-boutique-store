---
import { Cloudinary } from "@cloudinary/url-gen"
import { auto } from "@cloudinary/url-gen/actions/resize"

const cloudinary = new Cloudinary({
  cloud: {
    cloudName: import.meta.env.CLOUDINARY_CLOUD_NAME
  }
})

interface Props {
  src: string
  width: number
  height: number
  alt: string
  class?: string
}
const { src, ...props } = Astro.props as Props

const cldSrc = cloudinary
  .image(src)
  .format("auto")
  .quality("auto")
  .resize(auto().width(props.width).height(props.height).gravity("auto"))
if (src.startsWith("http")) cldSrc.setDeliveryType("fetch")
---

<img loading="lazy" src={cldSrc.toURL()} {...props} />
